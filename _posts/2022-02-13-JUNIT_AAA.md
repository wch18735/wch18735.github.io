---
title: "[Junit] AAA"
excerpt: "AAA"
date: 2022-02-13
category:
    - junit
tag:
    - tdd
    - unit testing
    - junit
    - tdd
author: 1FeS
toc: true
toc_label: "Contents"
toc_icon: "heart"
classes: wide
comments: true
---

## 4장 내용
- 준비-실행-단언 (AAA, Arange-Act-Assert)을 사용해 테스트를 가시적이고 일관성있게 만듦
- 메서드를 테스트하는 것이 아니라 동작을 테스트하여 테스트 코드의 유지 보수성을 높임
- 테스트 이름의 중요성
- `@Before` 와 `@After` Annotation 활용해 공통 초기화 및 정리 코드 설정
- 거슬리는 테스트를 안전하게 무시하는 방법 `@Ignore`

## AAA(Arange-Act-Assert) 이용한 테스트 일관성 유지
- 추가적으로 A `@After` 가 추가되어 AAAA 가 되는 경우도 있음
- 준비(Arrange): 테스트 코드를 실행하기 전 시스템이 적절한 상태에 있는지 확인
- 실행(Act): 테스트 코드 실행. 보통 단일 메서드 실행
- 단언(Assert): 실행한 코드가 기대한 대로 동작하는지 확인.
- 사후(After): 테스트 실행 시 할당한 자원들을 정리해 다음 테스트에서 혼선이 발생하지 않도록 함

## 동작 테스트 vs 메서드 테스트
메서드를 테스트하는 것이 아니라 객체가 가진 **동작**이 무엇인지 생각해보고, 이를 메서드로 나누어 테스트 할 수 있도록 설계하는 능력 필요.

## 테스트와 프로덕션 코드의 관계
- iloveyouboss 폴더와 같이 src/test 폴더를 나눠 관리하는 것
- 테스트 코드는 프로덕션 시스템 코드를 의존하지만, 반대는 해당하지 않음
- 단위 테스트는 개발자만 하는 행동으로 프로덕션 코드에 제공될 필요 없음
- 보안상으로 이슈가 되리 수 있기에 따로 관리하는 것을 추천!
- 테스트 과정에서 private 메서드를 테스트 해야 할 때
  - 테스트가 프로덕션 코드와 같은 패키지에 있으면 패키지 수준 접근
  - 다른 패키지에 있다면 리플렉션으로 접근 권한 우회 가능
  - 그러나 두 가지 방법 다 추천하지 않음 (내부 private 은 테스트하지 말자!)

## 단일 목적 테스트
- **Tip:** 다수의 케이스를 별도의 JUnit 테스트로 분리해 각각에 검증하는 동작을 표현하는 이름 붙이기
- 테스트를 분리하면
  - 단언이 실패했을 때 실패한 테스트 이름이 표시되기 때문에 어떤 동작에서 문제되는지 확인 가능
  - 실패한 테스트 해독하는 데 필요한 시간을 줄일 수 있음 (어떤 부분이 영향을 끼쳤는지 복잡한 해석이 필요 없음)
  - 모든 케이스가 실행되었음을 보장할 수 있음 (한 개가 실패하면 모든 테스트가 멈추기 때문)
  - 결론은 가능하면 최대한 잘게 쪼개서 모든 경우를 검사해보기

## 테스트 문서화
- 단위 테스트는 클래스에 대한 지속적이고 믿을 수 있는 문서 역할을 해야함
- 즉, **코드 자체가 하나의 문서로서 다뤄져야 한다** 라는 개발자 격언과 일치
- 테스트는 주석보다 정확하고, 유용한 가치를 제공해야 함
- 테스트 문서화 방법
 - 일관성 있는 이름으로 테스트 문서화
   - 어떤 동작을 하면 어떤 결과가 나온다
   - 어떤 결과는 어떤 조건에서 발생한다
   - 행위 주도 개발(BDD, Behavior-Driven-Development) 에서 말하는 given-when-then 같은 양식 사용 가능 
 - 테스트를 의미있게 만들기
   - 주석을 추가하지 않고 어떤 기능하는지 알 수 있게 하는 것을 목표로 하기
   - 지역 변수 이름 개선
   - 의미 있는 상수 도입
   - 햄크레스트 단언 사용으로 가독성 높이기
   - 테스트를 잘게 쪼개서 집중적 테스트 만들기
   - 테스트 군더더기들을 도우미 메서드와 `@Before` 메서드로 이동시키기

## @Before 와 @After
- setup 메서드라고도 함
- 연관된 행동 집합(같은 의미의 동작)을 한 곳에 묶어주는 역할
- 실행 순서는 `@Before` → 테스트 → `@After`
- 테스트 과정에서는 순서를 보장하지 못 하나 테스트 시작 전과 후는 지정할 수 있음
- 다수의 `@Before` 또는 `@After` 가 있을 경우 순서 보장할 수 없음
- 매 테스트가 발생할 때마다 실행되며 Cycle 을 형성

## BeforeClass 와 AfterClass
보통의 테스트는 `@Before` 또는 `@After` 수준 초기화로 충분함. 드물게 클래스에 있는 어떤 테스트를 진행할 때 **단 한 번만 초기화를 진행할 때** 사용함.

## 테스트 무시
`@Ignore` 어노테이션 사용. 이를 이용해 테스트 속도를 향상시킬 수 있음.

## Questions
- **4.2 동작 테스트 vs 메서드 테스트 (p.80)** 에서 하고 싶은 말이 정확히 뭘까...